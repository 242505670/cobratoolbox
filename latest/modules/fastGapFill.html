

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>fastGapFill &mdash; The COBRA Toolbox</title>
  

  
  

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/cobra.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="The COBRA Toolbox" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" />
          
          </a>
          <h1>The COBRA Toolbox</h1>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../index.html">The COBRA Toolbox</a></li>
              </ul>
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../funding.html">Funding</a></li>
</ul>

          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The COBRA Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../contents.html">Docs</a> &raquo;</li>
        
      <li>fastGapFill</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fastgapfill">
<span id="id1"></span><h1>fastGapFill<a class="headerlink" href="#fastgapfill" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="AuxillaryFiles.html">AuxillaryFiles</a></li>
</ul>
</div>
<span class="target" id="module-src.reconstruction.fastGapFill"></span><dl class="function">
<dt id="src.reconstruction.fastGapFill.fastGapFill">
<code class="descname">fastGapFill</code><span class="sig-paren">(</span><em>consistMatricesSUX</em>, <em>epsilon</em>, <em>weights</em>, <em>weightsPerReaction</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/5a1c951fa98154dddbb97c6fc6c3e70bb24ea73f/src/reconstruction/fastGapFill/fastGapFill.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.reconstruction.fastGapFill.fastGapFill" title="Permalink to this definition">¶</a></dt>
<dd><p>function [AddedRxns] = fastGapFill(consistMatricesSUX,epsilon,weights,weightsPerReaction)</p>
<p>This function requires the fastCORE algorithm (Vlassis et al., 2013, <a class="reference external" href="http://arxiv.org/abs/1304.7992">http://arxiv.org/abs/1304.7992</a>) as
well as the output from prepareFastGapFill.</p>
<p>Requires the openCOBRA toolbox
<a class="reference external" href="http://opencobra.sourceforge.net/openCOBRA/Welcome.html">http://opencobra.sourceforge.net/openCOBRA/Welcome.html</a></p>
<p>Getting the Latest Code From the Subversion Repository:
Linux:
svn co <a class="reference external" href="https://opencobra.svn.sourceforge.net/svnroot/opencobra/cobra-devel">https://opencobra.svn.sourceforge.net/svnroot/opencobra/cobra-devel</a>
INPUT
consistMatricesSUX    To be obtained from prepareFastGapFill
epsilon               Parameter for fastCore (optional input, default:</p>
<blockquote>
<div>1e-4). Please refer to Vlassis et al. to get more
details on this parameter.</div></blockquote>
<dl class="docutils">
<dt>weights                Weight structure that permits to add weights to</dt>
<dd><p class="first">non-core reactions (it is recommended to use values other than 0 and 1, with lower weight
corresponding to higher priority.
Format:</p>
<blockquote>
<div>weights.MetabolicRxns = 10; % Universal database metabolic reactions
weights.ExchangeRxns = 10; % Exchange reactions
weights.TransportRxns = 10; % Transport reactions</div></blockquote>
<p class="last">Optional input. Default: weigth of 10 for all non-core
reactions.</p>
</dd>
</dl>
<p>weightsPerReaction
OUTPUT
AddedRxns             Reactions that have been added from UX matrix to S</p>
<p>June 2013
Ines Thiele, <a class="reference external" href="http://thielelab.eu">http://thielelab.eu</a>.</p>
</dd></dl>

<dl class="function">
<dt id="src.reconstruction.fastGapFill.generateSUXMatrix">
<code class="descname">generateSUXMatrix</code><span class="sig-paren">(</span><em>model</em>, <em>dictionary</em>, <em>KEGGFilename</em>, <em>KEGGBlackList</em>, <em>compartment</em>, <em>addModel</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/5a1c951fa98154dddbb97c6fc6c3e70bb24ea73f/src/reconstruction/fastGapFill/generateSUXMatrix.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.reconstruction.fastGapFill.generateSUXMatrix" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>generateSUXMatrix creates the matrices for matlab smiley &#8211; &gt; combines S, U</dt>
<dd><p class="first">(KEGG), X (transport)</p>
<blockquote class="last">
<div>MatricesSUX =generateSUXMatrix(model,CompAbr, KEGGID,
KEGGFilename, compartment)</div></blockquote>
</dd>
</dl>
<p>model          model structure
CompAbr        List of compounds abreviation (non-compartelized)
KEGGID         List of KEGGIDs for compounds in CompAbr
KEGGFilename   File name containing KEGG database
KEGGBlackList
compartment   [c] &#8211;&gt; transport from cytoplasm [c] to extracellulat space</p>
<blockquote>
<div>[e] (default), [p] creates transport from [c] to [p] and from [p] to [c],
if &#8216;&#8217; - no exchange reactions/transport will be added to the matrix.</div></blockquote>
<dl class="docutils">
<dt>addModel      model structure, containing an additional matrix or model</dt>
<dd>that should be combined with SUX matrix.% Note that the naming of metabolites in this matrix has to be identical to
model naming. Also, the list should be unique.</dd>
</dl>
<p>11-10-07 IT</p>
</dd></dl>

<dl class="function">
<dt id="src.reconstruction.fastGapFill.identifyBlockedRxns">
<code class="descname">identifyBlockedRxns</code><span class="sig-paren">(</span><em>model</em>, <em>epsilon</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/5a1c951fa98154dddbb97c6fc6c3e70bb24ea73f/src/reconstruction/fastGapFill/identifyBlockedRxns.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.reconstruction.fastGapFill.identifyBlockedRxns" title="Permalink to this definition">¶</a></dt>
<dd><p>function [consistModel, BlockedRxns] = identifyBlockedRxns(model,epsilon)</p>
<p>This function computes all blocked reactions using the approach described
in &#8220;The FASTCORE algorithm for context-specific metabolic network reconstructions&#8221;, Vlassis et
al., 2013, PLoS Comp Biol.</p>
<p>% Requires the openCOBRA toolbox
<a class="reference external" href="http://opencobra.sourceforge.net/openCOBRA/Welcome.html">http://opencobra.sourceforge.net/openCOBRA/Welcome.html</a></p>
<p>Getting the Latest Code From the Subversion Repository:
Linux:
svn co <a class="reference external" href="https://opencobra.svn.sourceforge.net/svnroot/opencobra/cobra-devel">https://opencobra.svn.sourceforge.net/svnroot/opencobra/cobra-devel</a></p>
<p>INPUT
model         Model structure
epsilon       Parameter(default: 1e-4; see Vlassis et al for more details)</p>
<p>OUTPUT
consistModel  Flux consistent model that does not contain any blocked</p>
<blockquote>
<div>reactions anymore</div></blockquote>
<dl class="docutils">
<dt>BlockedRxns   Structure containing all blocked reactions and their reaction formula that were in</dt>
<dd>model</dd>
</dl>
<p>Dec 2013
Ines Thiele, <a class="reference external" href="http://thielelab.eu">http://thielelab.eu</a></p>
</dd></dl>

<dl class="function">
<dt id="src.reconstruction.fastGapFill.postProcessGapFillSolutions">
<code class="descname">postProcessGapFillSolutions</code><span class="sig-paren">(</span><em>AddedRxns</em>, <em>model</em>, <em>BlockedRxns</em>, <em>IdentifyPW</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/5a1c951fa98154dddbb97c6fc6c3e70bb24ea73f/src/reconstruction/fastGapFill/postProcessGapFillSolutions.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.reconstruction.fastGapFill.postProcessGapFillSolutions" title="Permalink to this definition">¶</a></dt>
<dd><p>[AddedRxnsExtended] = postProcessGapFillSolutions(AddedRxns,model,BlockedRxns,IdentifyPW)</p>
<p>This function uses the output from fastGapFill and signs generalized
function to the identified solutions from the universal database (e.g.,
&#8216;Metabolic reaction&#8217;, &#8216;Transport reaction&#8217;, &#8216;Exchange reaction&#8217;). It also
provides basic statistics for the solution. One can use the option
&#8216;IdentifyPW&#8217; to compute for each solved blocked reaction a flux vector,
such that the flux through this reaction is maximized while the sum of
all fluxes is minimized. This analysis can be helpful to put the solution
reactions into the network context.</p>
<p>INPUT
AddedRxns             Output from fastGapFill.m
model                 Model structure. Original model given as input into prepareFastGapFill
IdentifyPW            Optional: identifies reactions that are need from</p>
<blockquote>
<div>consistent model and added reactions to have flux through previously
blocked reaction. default: false</div></blockquote>
<p>OUTPUT
AddedRxnsExtended     Structure containing the information present in</p>
<blockquote>
<div>AddedRxns along with the statistics and if desired pathways containing
the flux vectors.</div></blockquote>
<p>June 2013
Ines Thiele, <a class="reference external" href="http://thielelab.eu">http://thielelab.eu</a></p>
</dd></dl>

<dl class="function">
<dt id="src.reconstruction.fastGapFill.prepareFastGapFill">
<code class="descname">prepareFastGapFill</code><span class="sig-paren">(</span><em>model</em>, <em>listCompartments</em>, <em>epsilon</em>, <em>filename</em>, <em>dictionary_file</em>, <em>blackList</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/5a1c951fa98154dddbb97c6fc6c3e70bb24ea73f/src/reconstruction/fastGapFill/prepareFastGapFill.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.reconstruction.fastGapFill.prepareFastGapFill" title="Permalink to this definition">¶</a></dt>
<dd><p>function [consistModel,consistMatricesSUX,allBlockedRxns,solvableBlockedRxns] = prepareFastGapFill(model,epsilon,filename,dictionary_file,blackList)</p>
<p>This function is required to generate the input data for fastGapFill.</p>
<p>This function generate the input file (consistMatricesSUX) for
fastGapFill.m. Please refer to Thiele et al, 2013 for more details.</p>
<p>This function is based on the fastCORE algorithm (Vlassis et al., 2013).</p>
<p>Requires the openCOBRA toolbox
<a class="reference external" href="http://opencobra.sourceforge.net/openCOBRA/Welcome.html">http://opencobra.sourceforge.net/openCOBRA/Welcome.html</a></p>
<p>Getting the Latest Code From the Subversion Repository:
Linux:
svn co <a class="reference external" href="https://opencobra.svn.sourceforge.net/svnroot/opencobra/cobra-devel">https://opencobra.svn.sourceforge.net/svnroot/opencobra/cobra-devel</a>
INPUT
model                 Model structure
listCompartments      List of intracellular compartments in the model</p>
<blockquote>
<div>(optional input, default compartments to be considered: &#8216;[c]&#8217;,&#8217;[m]&#8217;,&#8217;[l]&#8217;,&#8217;[g]&#8217;,&#8217;[r]&#8217;,&#8217;[x]&#8217;,&#8217;[n]&#8217;)</div></blockquote>
<dl class="docutils">
<dt>epsilon               Parameter for fastCore (optional input, default:</dt>
<dd>1e-4). Please refer to Vlassis et al. to get more
details on this parameter.</dd>
</dl>
<p>filename              File name containing universal database (e.g., KEGG; optional input, default: reaction.lst)
dictionary_file       List of universal database IDs and their counterpart in the model</p>
<blockquote>
<div>(optional input, default: KEGG_dictionary.xls)</div></blockquote>
<dl class="docutils">
<dt>blackList             List of excluded reactions from the universal database</dt>
<dd>(e.g., KEGG) (optional input, default: no
blacklist)</dd>
</dl>
<p>OUTPUT
consistModel          Flux consistent subnetwork of the input model
consistMatricesSUX    Flux consistent SUX matrix, which contains the flux</p>
<blockquote>
<div>consistent S matrix (model), the universal database placed in all
cellular compartments along with transport reactions for each metabolite
from cytosol to compartment and exchange reactions for all extracellular
metabolites.</div></blockquote>
<p>BlockedRxns           Blocked reactions in model
June 2013
Ines Thiele, <a class="reference external" href="http://thielelab.eu">http://thielelab.eu</a></p>
</dd></dl>

<dl class="function">
<dt id="src.reconstruction.fastGapFill.submitFastGapFill">
<code class="descname">submitFastGapFill</code><span class="sig-paren">(</span><em>modelFile</em>, <em>dbFile</em>, <em>dictionaryFile</em>, <em>prepareFGFResults</em>, <em>weightsPerRxnFile</em>, <em>forceRerun</em>, <em>epsilon</em>, <em>blackList</em>, <em>listCompartments</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/5a1c951fa98154dddbb97c6fc6c3e70bb24ea73f/src/reconstruction/fastGapFill/submitFastGapFill.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.reconstruction.fastGapFill.submitFastGapFill" title="Permalink to this definition">¶</a></dt>
<dd><p>function [AddedRxns] = submitFastGapFill(modelFile,dbFile,dictionaryFile,prepareFGFResults,weightsPerRxnFile,forceRerun,epsilon,blackList,listCompartments)</p>
<p>A test function for both prepareFastGapFill and
fastGapFill, allowing all files to be optionally specified and not
requiring prepareFastGapFill to be rerun (if relevant variables are saved
in a specified workspace file) if it has already been run.</p>
<p>This function performs three runs of fastGapFill on the same prepared
model, with weights as specified in the &#8216;Define Runs&#8217; section of the
code.  The &#8216;runs&#8217; variable can be appended to or changed to enable the
running of fastGapFill for different combinations of weights (and
different weightsPerRxnFile files).</p>
<p>This function draws inspiration heavily from the example already
available for fastGapFill, i.e. runGapFill_example.m</p>
<p>N.B. The defaults are set for testing all of the functionality of the
algorithm, including setting a (toy) weight file, which is not necessary
in running fastGapFill so should be specified as empty if running without
a weight file.</p>
<p>INPUT (ALL optional, defaults to E. coli model iAF1260 and example files)
modelFileIn         File containing model, either .mat or .xml</p>
<blockquote>
<div>(default: &#8216;examples/iAF1260.mat&#8217;)</div></blockquote>
<dl class="docutils">
<dt>dbFileIn            File containing universal database</dt>
<dd>(default: &#8216;AuxillaryFiles/reaction.lst&#8217;)</dd>
<dt>dictionaryFileIn    File containing db metabolite IDs and model</dt>
<dd>counterparts, either .xls or .tsv
(default: &#8216;AuxillaryFiles/KEGG_dictionary.xls&#8217;)</dd>
<dt>workspaceFileIn     File for storing prepareFastGapFill results</dt>
<dd>(default: &#8216;examples/defaultWorkspace.mat&#8217;)</dd>
<dt>weightsPerRxnFile   File containing individual weights for reactions</dt>
<dd>(default: &#8216;examples/sampleWeights.tsv&#8217;)</dd>
<dt>forceRerun          Boolean specifying whether to rerun</dt>
<dd><p class="first">prepareFastGapFill even if it has already been
run. N.B. If this is set to &#8216;true&#8217; it will overwrite
the precalculated default results files, unless
prepareFGFResults is specified outside the examples
directory</p>
<blockquote class="last">
<div>(default: false)</div></blockquote>
</dd>
<dt>epsilon             Float, a fastCore parameter</dt>
<dd>(default: 1e-4)</dd>
<dt>blackList           List of excluded universal DB reactions</dt>
<dd>(default: none)</dd>
<dt>listCompartments    List of compartments in the model to be gapFilled N.B.</dt>
<dd><dl class="first last docutils">
<dt>the default is set within prepareGapFill</dt>
<dd>(default: all compartments specified in the model)</dd>
</dl>
</dd>
</dl>
<p>OUTPUT
AddedRxns           Reactions that have been added from UX matrix to S</p>
<p>Jan 2016
Will Bryant
Preparation - load data
Suppress load warnings and deal with in the function</p>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, The COBRA Toolbox developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>