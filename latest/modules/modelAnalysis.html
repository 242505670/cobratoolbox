

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Model analysis &mdash; The COBRA Toolbox</title>
  

  
  

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/cobra.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="The COBRA Toolbox" href="../index.html"/>
        <link rel="up" title="Documentation" href="index.html"/>
        <link rel="next" title="FBA" href="FBA.html"/>
        <link rel="prev" title="Design" href="design.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" />
          
          </a>
          <h1>The COBRA Toolbox</h1>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../index.html">The COBRA Toolbox</a></li>
              </ul>
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="base.html">Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataIntegration.html">Data integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="design.html">Design</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Model analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="FBA.html">FBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="FVA.html">FVA</a></li>
<li class="toctree-l3"><a class="reference internal" href="MOMA.html">MOMA</a></li>
<li class="toctree-l3"><a class="reference internal" href="deletion.html">Deletion</a></li>
<li class="toctree-l3"><a class="reference internal" href="exploration.html">Exploration</a></li>
<li class="toctree-l3"><a class="reference internal" href="multiSpecies.html">MultiSpecies</a></li>
<li class="toctree-l3"><a class="reference internal" href="rFBA.html">rFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="relaxFBA.html">relaxFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="sampling.html">Sampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="sparseFBA.html">sparseFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="subspaces.html">Subspaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="topology.html">Topology</a></li>
<li class="toctree-l3"><a class="reference internal" href="transport.html">Transport</a></li>
<li class="toctree-l3"><a class="reference internal" href="rumba.html">rumba</a></li>
<li class="toctree-l3"><a class="reference internal" href="coupling.html">Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mdFBA.html">mdFBA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reconstruction.html">Reconstruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../funding.html">Funding</a></li>
</ul>

          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The COBRA Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Documentation</a> &raquo;</li>
        
      <li>Model analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="model-analysis">
<span id="modelanalysis"></span><h1>Model analysis<a class="headerlink" href="#model-analysis" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="FBA.html">FBA</a></li>
<li class="toctree-l1"><a class="reference internal" href="FVA.html">FVA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fastFVA.html">fastFVA</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MOMA.html">MOMA</a></li>
<li class="toctree-l1"><a class="reference internal" href="deletion.html">Deletion</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">Exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiSpecies.html">MultiSpecies</a></li>
<li class="toctree-l1"><a class="reference internal" href="rFBA.html">rFBA</a></li>
<li class="toctree-l1"><a class="reference internal" href="relaxFBA.html">relaxFBA</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparseFBA.html">sparseFBA</a></li>
<li class="toctree-l1"><a class="reference internal" href="subspaces.html">Subspaces</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lsqr.html">Lsqr</a></li>
<li class="toctree-l2"><a class="reference internal" href="nullspace.html">Nullspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="rank.html">Rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="rowReduce.html">rowReduce</a></li>
<li class="toctree-l2"><a class="reference internal" href="subspaceProjection.html">subspaceProjection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="topology.html">Topology</a><ul>
<li class="toctree-l2"><a class="reference internal" href="circuits.html">Circuits</a></li>
<li class="toctree-l2"><a class="reference internal" href="conservedMoieties.html">conservedMoieties</a></li>
<li class="toctree-l2"><a class="reference internal" href="extremeRays.html">extremeRays</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lrs.html">lrs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lrsInterface.html">lrsInterface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="optimalRays.html">optimalRays</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="FR.html">FR</a></li>
<li class="toctree-l2"><a class="reference internal" href="graphHypergraphConversion.html">graphHypergraphConversion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transport.html">Transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="rumba.html">rumba</a></li>
<li class="toctree-l1"><a class="reference internal" href="coupling.html">Coupling</a></li>
<li class="toctree-l1"><a class="reference internal" href="mdFBA.html">mdFBA</a></li>
</ul>
</div>
<span class="target" id="module-src.modelAnalysis"></span><dl class="function">
<dt id="src.modelAnalysis.FEA">
<code class="descname">FEA</code><span class="sig-paren">(</span><em>model</em>, <em>rxnSet</em>, <em>group</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/ca8a995e5224f908851f4acf3771908f02954670/src/modelAnalysis/FEA.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.modelAnalysis.FEA" title="Permalink to this definition">¶</a></dt>
<dd><p>Significane analysis - Flux enrichment analysis using hypergeometric
1-sided test and FDR correction for multiple testing</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>resultCellF = FEA(modelEcore, 1:10, &#8216;subSystems&#8217;)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
COBRA structure model</li>
<li><strong>rxnSet</strong> &#8211;
reaction set to be enriched (vector of reaction indices)</li>
<li><strong>group</strong> &#8211;
model.(group) structure e.g.
&#8216;subSystems&#8217; look for significantly enriched subsystem in rxnSet</li>
</ul>
</div></blockquote>
<p><strong>Output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>resultCellF</strong> &#8211;
cell structure of enriched groups</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.modelAnalysis.biomassPrecursorCheck">
<code class="descname">biomassPrecursorCheck</code><span class="sig-paren">(</span><em>model</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/ca8a995e5224f908851f4acf3771908f02954670/src/modelAnalysis/biomassPrecursorCheck.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.modelAnalysis.biomassPrecursorCheck" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if biomass precursors are able to be synthesized.</p>
<p>[missingMets, presentMets] = checkBiomassPrecursors(model)</p>
<p><strong>Input</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
COBRA model structure</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>missingMets</strong> &#8211;
List of biomass precursors that are not able to be synthesized</li>
<li><strong>presentMets</strong> &#8211;
List of biomass precursors that are able to be synthesized</li>
</ul>
</div></blockquote>
<p>May identify metabolites that are typically recycled within the
network such as ATP, NAD, NADPH, ACCOA.</p>
</dd></dl>

<dl class="function">
<dt id="src.modelAnalysis.convertIrrevFluxDistribution">
<code class="descname">convertIrrevFluxDistribution</code><span class="sig-paren">(</span><em>vIrrev</em>, <em>matchRev</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/ca8a995e5224f908851f4acf3771908f02954670/src/modelAnalysis/convertIrrevFluxDistribution.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.modelAnalysis.convertIrrevFluxDistribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts irreversible flux distribution to reversible</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>vRev = covertIrrevFluxDistribution(vIrrev, matchRev)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>vIrrev</strong> &#8211;
Irreversible flux distribution</li>
<li><strong>matchRev</strong> &#8211;
Vector mapping irreversible fluxes to reversible fluxes
(Generated by <cite>convertToIrreversible</cite>)</li>
</ul>
</div></blockquote>
<p><strong>Output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>vRev</strong> &#8211;
Reversible flux distribution</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.modelAnalysis.doubleRobustnessAnalysis">
<code class="descname">doubleRobustnessAnalysis</code><span class="sig-paren">(</span><em>model</em>, <em>controlRxn1</em>, <em>controlRxn2</em>, <em>nPoints</em>, <em>plotResFlag</em>, <em>objRxn</em>, <em>objType</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/ca8a995e5224f908851f4acf3771908f02954670/src/modelAnalysis/doubleRobustnessAnalysis.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.modelAnalysis.doubleRobustnessAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs robustness analysis for a pair of reactions of
interest and an objective of interest</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[controlFlux1, controlFlux2, objFlux] = doubleRobustnessAnalysis(model, controlRxn1, controlRxn2, nPoints, plotResFlag, objRxn, objType)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
COBRA model structure</li>
<li><strong>controlRxn1</strong> &#8211;
Reaction of interest whose value is to be controlled</li>
<li><strong>controlRxn2</strong> &#8211;
Reaction of interest whose value is to be controlled</li>
</ul>
</div></blockquote>
<p><strong>Optional inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>nPoints</strong> &#8211;
Number of flux values per dimension (Default = 20)</li>
<li><strong>plotResFlag</strong> &#8211;
Plot results (Default = true)</li>
<li><strong>objRxn</strong> &#8211;
Objective reaction to be maximized (Default = whatever
is defined in model)</li>
<li><strong>objType</strong> &#8211;
Maximize (&#8216;max&#8217;) or minimize (&#8216;min&#8217;) objective
(Default = &#8216;max&#8217;)</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>controlFlux</strong> &#8211;
Flux values within the range of the maximum and minimum for
reaction of interest</li>
<li><strong>objFlux</strong> &#8211;
Optimal values of objective reaction at each control
reaction flux value</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.modelAnalysis.dynamicFBA">
<code class="descname">dynamicFBA</code><span class="sig-paren">(</span><em>model</em>, <em>substrateRxns</em>, <em>initConcentrations</em>, <em>initBiomass</em>, <em>timeStep</em>, <em>nSteps</em>, <em>plotRxns</em>, <em>exclUptakeRxns</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/ca8a995e5224f908851f4acf3771908f02954670/src/modelAnalysis/dynamicFBA.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.modelAnalysis.dynamicFBA" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs dynamic FBA simulation using the static optimization approach</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[concentrationMatrix, excRxnNames, timeVec, biomassVec] = dynamicFBA(model, substrateRxns, initConcentrations, initBiomass, timeStep, nSteps, plotRxns, exclUptakeRxns)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
COBRA model structure</li>
<li><strong>substrateRxns</strong> &#8211;
List of exchange reaction names for substrates
initially in the media that may change (e.g. not
h2o or co2)</li>
<li><strong>initConcentrations</strong> &#8211;
Initial concentrations of substrates (in the same
structure as <cite>substrateRxns</cite>)</li>
<li><strong>initBiomass</strong> &#8211;
Initial biomass (must be non zero)</li>
<li><strong>timeStep</strong> &#8211;
Time step size</li>
<li><strong>nSteps</strong> &#8211;
Maximum number of time steps</li>
</ul>
</div></blockquote>
<p><strong>Optional inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>plotRxns</strong> &#8211;
Reactions to be plotted (Default = {&#8216;EX_glc(e)&#8217;, &#8216;EX_ac(e)&#8217;, &#8216;EX_for(e)&#8217;})</li>
<li><strong>exclUptakeRxns</strong> &#8211;
List of uptake reactions whose substrate concentrations do not change
(Default = {&#8216;EX_co2(e)&#8217;, &#8216;EX_o2(e)&#8217;, &#8216;EX_h2o(e)&#8217;, &#8216;EX_h(e)&#8217;})</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>concentrationMatrix</strong> &#8211;
Matrix of extracellular metabolite concentrations</li>
<li><strong>excRxnNames</strong> &#8211;
Names of exchange reactions for the EC metabolites</li>
<li><strong>timeVec</strong> &#8211;
Vector of time points</li>
<li><strong>biomassVec</strong> &#8211;
Vector of biomass values</li>
</ul>
</div></blockquote>
<p>If no initial concentration is given for a substrate that has an open
uptake in the model (i.e. <cite>model.lb &lt; 0</cite>) the concentration is assumed to
be high enough to not be limiting. If the uptake rate for a nutrient is
calculated to exceed the maximum uptake rate for that nutrient specified
in the model and the max uptake rate specified is &gt; 0, the maximum uptake
rate specified in the model is used instead of the calculated uptake
rate.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The dynamic FBA method implemented in this function is essentially
the same as the method described in
[<cite>Varma, A., and B. O. Palsson. Appl. Environ. Microbiol. 60:3724 (1994)</cite>].
This function does not implement the dynamic FBA using dynamic optimization approach
described in [<cite>Mahadevan, R. et al. Biophys J, 83:1331-1340 (2003)</cite>].</p>
</div>
</dd></dl>

<dl class="function">
<dt id="src.modelAnalysis.geometricFBA">
<code class="descname">geometricFBA</code><span class="sig-paren">(</span><em>model</em>, <em>varargin</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/ca8a995e5224f908851f4acf3771908f02954670/src/modelAnalysis/geometricFBA.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.modelAnalysis.geometricFBA" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a unique optimal FBA solution that is (in some sense)
central to the range of possible fluxes; as described in
<cite>K Smallbone, E Simeonidis (2009). Flux balance analysis:
A geometric perspective. J Theor Biol 258: 311-315
http://dx.doi.org/10.1016/j.jtbi.2009.01.027</cite></p>
<p><strong>Usage</strong></p>
<blockquote>
<div>flux = geometricFBA(model, varargin)</div></blockquote>
<p><strong>Input</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
COBRA model structure</li>
</ul>
</div></blockquote>
<p><strong>Optional inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>printLevel</strong> &#8211;
[default: 1]  printing level,
= 0 - silent
= 1 - show algorithm progress and times</li>
<li><strong>epsilon</strong> &#8211;
[default: 1e-6]      convergence tolerance of algorithm,
defined in more detail in paper above</li>
<li><strong>flexRel</strong> &#8211;
[default: 0] flexibility to flux bounds
try e.g. 1e-3 if the algorithm has convergence problems</li>
</ul>
</div></blockquote>
<p><strong>Output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>flux</strong> &#8211;
unique centered flux</li>
</ul>
</div></blockquote>
<p>Optional parameters can be entered as parameter name followed by
parameter value: i.e. ...,&#8217;epsilon&#8217;, 1e-9)</p>
</dd></dl>

<dl class="function">
<dt id="src.modelAnalysis.minimizeModelFlux">
<code class="descname">minimizeModelFlux</code><span class="sig-paren">(</span><em>model</em>, <em>osenseStr</em>, <em>minNorm</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/ca8a995e5224f908851f4acf3771908f02954670/src/modelAnalysis/minimizeModelFlux.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.modelAnalysis.minimizeModelFlux" title="Permalink to this definition">¶</a></dt>
<dd><p>This function finds the minimum flux through the network and returns the
minimized flux and an irreversible model</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[MinimizedFlux modelIrrev]= minimizeModelFlux(model)</div></blockquote>
<p><strong>Input</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
COBRA model structure</li>
</ul>
</div></blockquote>
<p><strong>Optional inputs</strong></p>
<blockquote>
<div><ul>
<li><p class="first"><strong>osenseStr</strong> &#8211;
Maximize (&#8216;max&#8217;)/minimize (&#8216;min&#8217;) (opt, default = &#8216;max&#8217;)</p>
</li>
<li><p class="first"><strong>minNorm</strong> &#8211;
{(0), &#8216;one&#8217;, &#8216;zero&#8217;, &gt; 0 , <cite>n x 1</cite> vector}, where <cite>[m,n]=size(S)</cite>;
0 - Default, normal LP,
&#8216;one&#8217;  Minimise the Taxicab Norm using LP.</p>
<div class="math">
\[\begin{split}min  ~&amp;~ |v| \\
s.t. ~&amp;~ S v = b \\
     ~&amp;~ c^T v = f \\
     ~&amp;~ lb \leq v \leq ub\end{split}\]</div>
<p>A LP solver is required.
&#8216;zero&#8217; Minimize the cardinality (zero-norm) of v</p>
<div class="math">
\[\begin{split}min  ~&amp;~ ||v||_0 \\
s.t. ~&amp;~ S v = b \\
     ~&amp;~ c^T v = f \\
     ~&amp;~ lb \leq v \leq ub\end{split}\]</div>
<p>The zero-norm is approximated by a non-convex approximation
Six approximations are available: capped-L1 norm, exponential function
logarithmic function, SCAD function, L_p norm with p&lt;0, L_p norm with 0&lt;p&lt;1
Note : capped-L1, exponential and logarithmic function often give
the best result in term of sparsity.</p>
<p>The remaining options work only with a valid QP solver:</p>
<p>&gt; 0    Minimises the Euclidean Norm of internal fluxes.
Typically 1e-6 works well.</p>
<div class="math">
\[\begin{split}min  ~&amp;~ ||v||      \\
s.t. ~&amp;~ S v = b    \\
     ~&amp;~ c^T v = f  \\
     ~&amp;~ lb \leq v \leq ub\end{split}\]</div>
<p><cite>n</cite> x 1   Forms the diagonal of positive definiate
matrix <cite>F</cite> in the quadratic program</p>
<div class="math">
\[\begin{split}min  ~&amp;~ 0.5 v^T F v  \\
s.t. ~&amp;~ S v = b      \\
     ~&amp;~ c^T v = f    \\
    ~&amp;~ lb \leq v \leq ub\end{split}\]</div>
</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>MinimizedFlux</strong> &#8211;
minimum flux possible through the netwok</li>
<li><strong>modelIrrev</strong> &#8211;
irreversible version of &#8216;model&#8217;</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.modelAnalysis.pFBA">
<code class="descname">pFBA</code><span class="sig-paren">(</span><em>model</em>, <em>varargin</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/ca8a995e5224f908851f4acf3771908f02954670/src/modelAnalysis/pFBA.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.modelAnalysis.pFBA" title="Permalink to this definition">¶</a></dt>
<dd><p>Parsimoneous enzyme usage Flux Balance Analysis - method that optimizes
the user&#8217;s objective function and then minimizes the flux through the
model and subsequently classifies each gene by how it contributes to the
optimal solution. See <cite>Lewis, et al. Mol Syst Bio doi:10.1038/msb.2010.47</cite></p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[GeneClasses RxnClasses modelIrrevFM] = pFBA(model, varargin)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model            COBRA model</strong></li>
<li><strong>varargin</strong> &#8211;
including:<ul>
<li>&#8216;geneoption&#8217; - 0 = minimize the sum of all fluxes in the network,
1 = only minimize the sum of the flux through
gene-associated fluxes (default),
2 = only minimize the sum of the flux through
non-gene-associated fluxes</li>
<li>&#8216;map&#8217; - map structure from readCbMap.m (no map written if empty)</li>
<li>&#8216;mapoutname&#8217; - File Name for map</li>
<li>&#8216;skipclass&#8217; - 1 = Don&#8217;t classify genes and reactions. Only return
model with the minimium flux set as upper bound.
0 = classify genes and reactions (default).</li>
</ul>
</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>GeneClasses</strong> &#8211;
Structure with fields for each gene class</li>
<li><strong>RxnsClasses</strong> &#8211;
Structure with fields for each reaction class</li>
<li><strong>modelIrrevFM</strong> &#8211;
Irreversible model used for minimizing flux with
the minimum flux set as a flux upper bound</li>
</ul>
</div></blockquote>
<p>Note on maps: Red (6) = Essential reactions, Orange (5) = pFBA optima
reaction, Yellow (4) = ELE reactions, Green (3) = MLE reactions,
blue (2) = zero flux reactions, purple (1) = blocked reactions,
black (0) = not classified</p>
<p><strong>Example</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">GeneClasses</span> <span class="n">RxnClasses</span> <span class="n">modelIrrevFM</span><span class="p">]</span> <span class="o">=</span> <span class="n">pFBA</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;geneoption&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;tol&#39;</span><span class="p">,</span><span class="mf">1e-7</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="src.modelAnalysis.phenotypePhasePlane">
<code class="descname">phenotypePhasePlane</code><span class="sig-paren">(</span><em>model</em>, <em>controlRxn1</em>, <em>controlRxn2</em>, <em>nPts</em>, <em>range1</em>, <em>range2</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/ca8a995e5224f908851f4acf3771908f02954670/src/modelAnalysis/phenotypePhasePlane.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.modelAnalysis.phenotypePhasePlane" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots three phenotype phase planes for two reactions.  The first plot is
a double robustness analysis, a kind of 3D surface plot.  The second
two plots show the shadow prices of the metabolites from the two control
reactions, which define the phases.  Use the COLORMAP and SHADING
functions to change the looks of the plots.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[growthRates, shadowPrices1, shadowPrices2] = phenotypePhasePlane(model, controlRxn1, controlRxn2, nPts, range1, range2)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
COBRA model structure</li>
<li><strong>controlRxn1</strong> &#8211;
the first reaction to be plotted</li>
<li><strong>controlRxn2</strong> &#8211;
the second reaction to be plotted</li>
</ul>
</div></blockquote>
<p><strong>Optional inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>nPts</strong> &#8211;
the number of points to plot in each dimension (Default = 50)</li>
<li><strong>range1</strong> &#8211;
the range of reaction 1 to plot (Default = 20)</li>
<li><strong>range2</strong> &#8211;
the range of reaction 2 to plot (Default = 20)</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>growthRates1</strong> &#8211;
a matrix of maximum growth rates</li>
<li><strong>shadowPrices1</strong> &#8211;
a matrix of <cite>rxn</cite> 1 shadow prices</li>
<li><strong>shadowPrices2</strong> &#8211;
a matrix of <cite>rxn</cite> 2 shadow prices</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.modelAnalysis.productionEnvelope">
<code class="descname">productionEnvelope</code><span class="sig-paren">(</span><em>model</em>, <em>deletions</em>, <em>lineColor</em>, <em>targetRxn</em>, <em>biomassRxn</em>, <em>geneDelFlag</em>, <em>nPts</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/ca8a995e5224f908851f4acf3771908f02954670/src/modelAnalysis/productionEnvelope.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.modelAnalysis.productionEnvelope" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the byproduct secretion envelope</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[biomassValues, targetValues, lineHandle] = productionEnvelope(model, deletions, lineColor, targetRxn, biomassRxn, geneDelFlag, nPts)</div></blockquote>
<p><strong>Input</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
COBRA model structure</li>
</ul>
</div></blockquote>
<p><strong>Optional inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>deletions</strong> &#8211;
List of reaction or gene deletions (empty if wild type)</li>
<li><strong>lineColor</strong> &#8211;
Line color for plotting (see help plot for color codes)</li>
<li><strong>targetRxn</strong> &#8211;
Target metabolite production reaction name</li>
<li><strong>biomassRxn</strong> &#8211;
Biomass rxn name</li>
<li><strong>geneDelFlag</strong> &#8211;
Perform gene and not reaction deletions</li>
<li><strong>nPts</strong> &#8211;
Number of points in the plot</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>biomassValues</strong> &#8211;
Biomass values for plotting</li>
<li><strong>targetValues</strong> &#8211;
Target upper and lower bounds for plotting</li>
<li><strong>lineHandle</strong> &#8211;
Handle to lineseries object</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.modelAnalysis.robustnessAnalysis">
<code class="descname">robustnessAnalysis</code><span class="sig-paren">(</span><em>model</em>, <em>controlRxn</em>, <em>nPoints</em>, <em>plotResFlag</em>, <em>objRxn</em>, <em>objType</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/ca8a995e5224f908851f4acf3771908f02954670/src/modelAnalysis/robustnessAnalysis.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.modelAnalysis.robustnessAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs robustness analysis for a reaction of
interest and an objective of interest</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[controlFlux, objFlux] = robustnessAnalysis(model, controlRxn, nPoints, plotResFlag, objRxn, objType)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
COBRA model structure</li>
<li><strong>controlRxn</strong> &#8211;
Reaction of interest whose value is to be controlled</li>
</ul>
</div></blockquote>
<p><strong>Optional inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>nPoints</strong> &#8211;
Number of points to show on plot (Default = 20)</li>
<li><strong>plotResFlag</strong> &#8211;
Plot results (Default true)</li>
<li><strong>objRxn</strong> &#8211;
Objective reaction to be maximized
(Default = whatever is defined in model)</li>
<li><strong>objType</strong> &#8211;
Maximize (&#8216;max&#8217;) or minimize (&#8216;min&#8217;) objective
(Default = &#8216;max&#8217;)</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>controlFlux</strong> &#8211;
Flux values within the range of the maximum and minimum for
reaction of interest</li>
<li><strong>objFlux</strong> &#8211;
Optimal values of objective reaction at each control
reaction flux value</li>
</ul>
</div></blockquote>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="FBA.html" class="btn btn-neutral float-right" title="FBA" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="design.html" class="btn btn-neutral" title="Design" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, The COBRA Toolbox developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>