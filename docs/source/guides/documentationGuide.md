# Guide for documenting a MATLAB function

To enable automatic documentation generation the function has to be formatted properly.
Automatic documentation works on any comments that are placed between the function header and the first line of code. Anything starting with the comment sign `%` will be taken into consideration. There should be one free space between `%` and the text. After the last line of comment leave one empty line before the body of the function. The description begins with a short explanation of what the function does.
````Matlab
function [gdlsSolution, bilevelMILPProblem, gdlsSolutionStructs] = GDLS(model, targetRxns, varargin)
% GDLS (Genetic Design through Local Search) attempts to find genetic
% designs with greater in silico production of desired metabolites.
%
% here additional comment blocks are used

x = 5 % the body of the function begins after one empty line
````

Recognized fields that will be extracted as separate blocks are: `USAGE:`, `INPUT:` or `INPUTS:` (in case there is more than one input arguement), `OUTPUT:`, `OUTPUTS:` (as mentioned before), `EXAMPLE:` and `NOTE:`.
Each of them should have  some elements inside and should be separated from another block by an empty line. Any element of the block must be indented by 4 spaces from the comment sign `%`. If the indentation differ between the line, the line with less indentation will break those with more.

Block `USAGE:` shows how the function should be used. It is important to leave one empty line before using `USAGE:`, after using the keyword and after the example.
````Matlab
% the end of the description
%
% USAGE:
%
%    [gdlsSolution, bilevelMILPProblem, gdlsSolutionStructs] = GDLS(model, varargin)
%
% here the other section can begin
````

The elements of blocks: `INPUT:`, `INPUTS:`, `OUTPUT:` and `OUTPUTS:` must finish with a colon, after that a description is provided. The indentation between the argument with colon and the description should be minimally 4 spaces. Ideally descriptions begin at the same place, so arguments with shorter names have a longer free space before the description begins.
````Matlab
% INPUTS:
%    parsed:     A parsed model structure generated by `parseCD` function.
%    model:      A COBRA model Matlab structure.
%
% OUTPUT:
%    results:    contains three fields:
````
In case arguments are structures and it is needed to present the fields of the structure it is possible to list them. To do that an empty line is added and then in the next line after a small indent - 2 spaces, we list the sub-arguments beginning with a `*` and a space. It is not necessary to leave an empty line after listing sub-arguments and writing the next normal argument.
````Matlab
% OUTPUT:
%    results:    contains three fields:
%
%                  * listOfFound - A list of reactions in the test model that are
%                    present in the reference COBRA model.
%                  * listOfNotFound - A list of reactions in the test model that are NOT
%                    present in the reference COBRA model.
%                  * list_of_rxns_not_present_in_ReferenceModel - A list of reactions in
%                    the reference model that are NOT included in the test model.
%    next:       next argument
````
It is also possible to replace `*` with a numbered list. To do that use numbers with a dot `1.` instead of `*`.
````Matlab
% OPTIONAL INPUT:
%    infix_type:      'name' or 'id':
%
%                       1. 'name' indicates that 'infix' contains
%                          a list of reaction names, which are normally used in a
%                          COBRA model structure.
%                       2. 'id' indicates that 'infix'
%                          contains a list of IDs used in `CellDesigner` such as 're32'.
````
To provide a real example of usage the `EXAMPLE` block is given. It requires the same treating as `USAGE`. Leave one empty line before the keyword `EXAMPLE`, after it and after the properly indented (4 spaces) code snippet. Please leave a space after every coma and before and after `=`. Do not leave inside braces `{}, [], ()`.
````Matlab
% here another block can end
%
% EXAMPLE:
%
%    results_M = cmpM(parseRecon2_species, recon2)
%
% here another block can begin
````
In case there is a very important information that could not be left in the description of the function, you can use the `NOTE:` block. Apply the same rules as with `USAGE` and `EXAMPLE` - empty lines and indentation. Remember that you can always include a normal text in the end as long as you leave one space free after the comment sign.
This is example of a `NOTE:` and normal text after all blocks.
````Matlab
%
% NOTE:
%
%    See GUI Options on GUIDE's Tools menu.  Choose "GUI allows only one
%    instance to run (singleton)".
%
% This is an additional final comment that is not important enough to be a note
% but cannot be a description
````
To add the author follow one of two templates.
In case of only one author you can use the shorter version. Remember about the structure - one space, two dots, one space, keyword `Author`, colon.
````Matlab
%
% .. Author: - Name, date, additional information if needed

x = 5 % here the body of the function begins
````
In case there are more than one authors or the file was overhauled, improved, updated by multiple people use this version. Remember about equal indentation.
````Matlab
%
% .. Author:
%       - Name1, date, additional information if needed
%       - Name2, date, additional information if needed

x = 5 % here the body of the function begins
````
A complete example of a real function is provided here. In case of doubts follow the formatting of older functions. Remember about colons, indentations and keywords.
````Matlab
function [fname_out, var] = addMiriam(fname, fname_out, infix, model, infix_type, list, miriam_path)
% Adds Miriam information to `CellDesigner` XML file. The Miriam information
% is retrieved from a COBRA model structure using Metabolite/Reaction IDs as
% the name of entry. The omics data will be shown as texts hyperlinking to
% external databases in `CellDesigner` or `ReconMap` online.
%
% USAGE:
%
%    [fname_out, var] = addMiriam(fname, fname_out, infix, model, infix_type, list, miriam_path)
%
% INPUTS:
%    fname:           An XML file to be modified to include annotations.
%    fname_out:       The name of an output XML file.
%    infix:           A list of metabolite/reaction IDs to be used to retrieve omics data
%                     in the COBRA model structure.
%    model:           a COBRA model structure contains the annotations that can be
%                     retrieved by using the infix as the index value.
%    list:            Column 1 stores a list of the field names of the COBRA model
%                     strictures that contains MIRIAM information; Column 2 stores
%                     a list of MIRIAM types corresponding to each field; column 3
%                     stores a list of relations
%
% OPTIONAL INPUT:
%    infix_type:      'name' or 'id':
%
%                       1. 'name' indicates that 'infix' contains
%                          a list of reaction names, which are normally used in a
%                          COBRA model structure.
%                       2. 'id' indicates that 'infix'
%                          contains a list of IDs used in `CellDesigner` such as 're32'.
%    miriam_path:     the file path of the miriam registry's dataset (*.mat).
%
% OPTIONAL OUTPUT:
%    fname_out:       the name of an output XML file.
%    var:             the content of the modified XML file with annotations
%
% EXAMPLE:
%
%    %the following example command is intended to add all MIRIAM information
%    %for the metabolites in the ReconMap
%    [var] = addMiriam('ReconMap.xml', 'ReconMap_annotated.xml', recon2.mets(:), recon2)
%
% .. Author: - Longfei Mao, May 2015
````
